- name: Update Windows Service By Name and State
  hosts: "{{ TargetHost }}"
  gather_facts: no
  tasks:
    - name: Update Windows Service by State
      ansible.windows.win_service:
        name: "{{ WindowsServiceName }}"
        state: "{{ ServiceState }}"
        register: service_update

    - name: Show confirmation message
      ansible.builtin.debug:
        msg: >
          Host '{{ inventory_hostname }}' updated service '{{ WindowsServiceName }}' to state '{{ ServiceState }}'.